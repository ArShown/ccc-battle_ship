window.__require=function t(e,o,i){function n(s,c){if(!o[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}}var d=o[s]={exports:{}};e[s][0].call(d.exports,function(t){return n(e[s][1][t]||t)},d,d.exports,t,e,o,i)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({background:[function(t,e,o){"use strict";cc._RF.push(e,"515f5VvvkdENIUqN0Twk+37","background"),cc.Class({extends:cc.Component,properties:{bg1:cc.Node,bg2:cc.Node},setEnabled:function(){this.enabled=!0},setDisabled:function(){this.enabled=!1,this.node.stopAllActions()},onLoad:function(){this.triggerY=-this.bg1.height,this.enabled=!1,this.speed=100},start:function(){},update:function(t){this.bg1.y-=t*this.speed,this.bg2.y-=t*this.speed,this.bg1.y<=this.triggerY?this.bg1.y=this.bg2.y+this.bg1.height:this.bg2.y<=this.triggerY&&(this.bg2.y=this.bg1.y+this.bg1.height)}}),cc._RF.pop()},{}],board:[function(t,e,o){"use strict";cc._RF.push(e,"0f844G6mTVJebXtm2ORwxQE","board");var i=function(){function t(t,e){var o=[],i=!0,n=!1,r=void 0;try{for(var s,c=t[Symbol.iterator]();!(i=(s=c.next()).done)&&(o.push(s.value),!e||o.length!==e);i=!0);}catch(t){n=!0,r=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw r}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();cc.Class({extends:cc.Component,properties:{gridFrame:cc.Node,tokens:cc.SpriteFrame,meteorPreFab:cc.Prefab},isGridActived:function(t,e){return this.gridBox[t][e].params.isActived},gridMouseEnterStyle:function(t,e){var o=this.gridBox[t][e].getComponent(cc.Graphics);o.clear(),o.fillColor=new cc.Color(255,255,255,100),o.fillRect(0,0,this.gridSize,this.gridSize),o.enabled=!0},gridMouseLeaveStyle:function(t,e){var o=this.gridBox[t][e].getComponent(cc.Graphics);o.clear(),o.enabled=!1},spawnGrid:function(t,e){var o=new cc.Node("Grid_"+t+"_"+e);return o.addComponent(cc.Graphics).enabled=!1,o.addComponent(cc.Sprite).enabled=!1,o.params={meteor:null,isActived:!1,status:null},o.x=e*this.gridSize,o.y=t*this.gridSize,o.width=o.height=this.gridSize,o.parent=this.gridFrame,o},spawnBoard:function(){var t=this.gridFrame.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=new cc.Color(255,255,255,180),t.fillColor=new cc.Color(0,0,0,0),t.fillRect(0,0,this.gridFrame.width,this.gridFrame.height),t.stroke();for(var e=10*this.gridSize,o=0;o<10;o++){if(o>0){var i=this.gridSize*o;t.moveTo(0,i),t.lineTo(e,i),t.moveTo(i,0),t.lineTo(i,e)}for(var n=[],r=0;r<10;r++)n[r]=this.spawnGrid(o,r);this.gridBox[o]=n}t.stroke()},spawnMeteor:function(t){var e=this,o=cc.instantiate(this.meteorPreFab),n=o.getComponent("meteor");n.spawnMeteor(t);(function t(){n.getLocation(),n.location.some(function(t){var o=i(t,2),n=o[0],r=o[1];return e.gridBox[n][r].params.meteor})&&t()})(),n.setPosition(n.origin.col*this.gridSize,n.origin.row*this.gridSize),n.location.forEach(function(t){var o=i(t,2),r=o[0],s=o[1];e.gridBox[r][s].params.meteor=n}),this.node.addChild(o),this.meteorBox.push(o)},startHandler:function(){this.enabled=!0,this.spawnBoard(),this.spawnMeteor("A"),this.spawnMeteor("B"),this.spawnMeteor("C"),this.spawnMeteor("D"),this.spawnMeteor("E"),this.node.on(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.on(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this),this.node.on("touchstart",this.touchStartHandler,this),this.node.on("touchmove",this.mouseMoveHandler,this),this.node.on("touchend",this.mouseDownHandler,this)},overHandler:function(){this.meteorBox.forEach(function(t){return t.active=!0}),this.node.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.off(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this),this.node.off("touchstart",this.touchStartHandler,this),this.node.off("touchmove",this.mouseMoveHandler,this),this.node.off("touchend",this.mouseDownHandler,this)},checkIsOver:function(){return this.meteorBox.every(function(t){return t.getComponent("meteor").isShootDown})},getCurrentLocation:function(t,e){var o=[Math.min(9,parseInt((t-this._startY)/this.gridSize)),Math.min(9,parseInt((e-this._startX)/this.gridSize))],n=o[0],r=o[1];switch(this.getActiveBomb()){case 1:return[[n,r]];case 2:return[[n+1,r-1],[n+1,r+1],[n,r],[n-1,r-1],[n-1,r+1]].filter(function(t){var e=i(t,2),o=e[0],n=e[1];return o<=9&&n<=9&&o>=0&&n>=0});case 3:return[[n+1,r-1],[n+1,r],[n+1,r+1],[n,r-1],[n,r],[n,r+1],[n-1,r-1],[n-1,r],[n-1,r+1]].filter(function(t){var e=i(t,2),o=e[0],n=e[1];return o<=9&&n<=9&&o>=0&&n>=0})}},touchStartHandler:function(t){var e=this,o=t.getLocation(),n=o.x,r=o.y,s=this.getCurrentLocation(r,n);return s.forEach(function(t){var o=i(t,2),n=o[0],r=o[1];e.isGridActived(n,r)||e.gridMouseEnterStyle(n,r)}),this._prevLocations=s,!1},mouseMoveHandler:function(t){var e=this,o=t.getLocation(),n=o.x,r=o.y,s=this.getCurrentLocation(r,n),c=this._prevLocations.map(function(t){var e=i(t,2);return e[0]+"_"+e[1]});s.map(function(t){var e=i(t,2);return e[0]+"_"+e[1]});return s.filter(function(t){return-1===c.indexOf(t)}).length>0&&(this._prevLocations.forEach(function(t){var o=i(t,2),n=o[0],r=o[1];return e.gridMouseLeaveStyle(n,r)}),this._prevLocations=s),s.forEach(function(t){var o=i(t,2),n=o[0],r=o[1];e.isGridActived(n,r)||e.gridMouseEnterStyle(n,r)}),!1},mouseLeaveHandler:function(){var t=this;this._prevLocations.forEach(function(e){var o=i(e,2),n=o[0],r=o[1];t.isGridActived(n,r)||t.gridMouseLeaveStyle(n,r)})},mouseDownHandler:function(t){var e=this,o=t.getLocation(),n=o.x,r=o.y,s=this.getCurrentLocation(r,n);if(s.every(function(t){var o=i(t,2),n=o[0],r=o[1];return e.isGridActived(n,r)}))return!1;s.forEach(function(t){var o=i(t,2),n=o[0],r=o[1];e.gridMouseLeaveStyle(n,r);var s=e.gridBox[n][r],c=s.params.meteor,a=null!==c,h=s.getComponent(cc.Sprite);h.node.anchorX=h.node.anchorY=0,h.sizeMode=0,h.spriteFrame=a?e.hitSpriteFrame:e.missSpriteFrame,h.enabled=!0,s.params.isActived=!0,s.params.status=a?"hit":"miss",a&&!c.location.some(function(t){var o=i(t,2),n=o[0],r=o[1];return!e.gridBox[n][r].params.isActived})&&c.setShootDown()}),this.checkIsOver()&&this.changeGameStatusHandler("win"),this.minusBombCountHandler()},setMinusBombCountHandler:function(t){this.minusBombCountHandler=t},setGetActiveBombHandler:function(t){this.getActiveBomb=t},setGameStatusHandler:function(t){this.changeGameStatusHandler=t},onLoad:function(){this.enabled=!1,this.gridSize=50,this.node.width=this.node.height=500,this.gridBox=new Array(10).fill(new Array(10).fill(null)),this.meteorBox=[],this.gridFrame.zIndex=2,this.meteorPreFab.zIndex=1,this._startX=70,this._startY=230,this._prevLocations=[],this._isLegalPosition=!1,this.getActiveBomb=function(){return-1},this.minusBombCountHandler=function(){return!1},this.changeGameStatusHandler=function(){return null},this.missSpriteFrame=this.tokens.clone(),this.missSpriteFrame.setRect(new cc.rect(32,0,32,32)),this.hitSpriteFrame=this.tokens.clone(),this.hitSpriteFrame.setRect(new cc.rect(64,0,32,32))},start:function(){},onDestroy:function(){this.node.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMoveHandler,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.mouseLeaveHandler,this),this.node.off(cc.Node.EventType.MOUSE_DOWN,this.mouseDownHandler,this),this.node.off("touchstart",this.touchStartHandler,this),this.node.off("touchend",this.mouseDownHandler,this),this.node.off("touchmove",this.mouseMoveHandler,this)}}),cc._RF.pop()},{}],game:[function(t,e,o){"use strict";cc._RF.push(e,"69029jbr/dHXZ/UkTooxQDU","game"),cc.Class({extends:cc.Component,properties:{board:cc.Node,bomb1:cc.Node,bomb2:cc.Node,bomb3:cc.Node},switchActive:function(t,e){var o=this;(e=+e)!==this.bombActive&&0!==this.bombCount[e]&&(cc.loader.loadRes("prefab/bomb_normal",cc.Prefab,function(t,i){o.bombBox.forEach(function(t,o){if(0!==o&&o!==e){var n=t.getChildByName("bottom_flex__item__border");n.stopAllActions(),n.runAction(cc.rotateTo(0,0)),n.removeAllChildren(),n.addChild(cc.instantiate(i));var r=t.getChildByName("bottom_flex__item__bg").getComponent(cc.Graphics);r.clear(),r.fillColor="#0BA390",r.circle(0,-2,55),r.fill();var s=t.getChildByName("bottom_flex__item__content"),c=s.getChildByName("bomb_img");c.scale=.8,c.color=new cc.Color(136,136,136);var a=s.getChildByName("bomb_count");a.getComponent(cc.Label).fontSize=16,a.color=new cc.Color(136,136,136)}})}),cc.loader.loadRes("prefab/bomb_active",cc.Prefab,function(t,i){o.bombBox.forEach(function(t,o){if(0!==o&&o===e){var n=t.getChildByName("bottom_flex__item__border");n.removeAllChildren(),n.addChild(cc.instantiate(i)),n.runAction(cc.repeatForever(cc.rotateBy(7,360)));var r=t.getChildByName("bottom_flex__item__bg").getComponent(cc.Graphics);r.clear(),r.fillColor="#A2F7EC",r.circle(0,0,65),r.fill();var s=t.getChildByName("bottom_flex__item__content"),c=s.getChildByName("bomb_img");c.scale=1,c.color=new cc.Color(255,255,255);var a=s.getChildByName("bomb_count");a.getComponent(cc.Label).fontSize=20,a.color=new cc.Color(255,255,255)}})}),this.bombActive=e)},minusBombCount:function(){if(this.bombCount[this.bombActive]-=1,this.upgradeBombCount(),0===this.bombCount[this.bombActive]){var t=this.bombCount.findIndex(function(t){return t>0});t>0?this.switchActive(null,t):this.gameOver("lose")}},upgradeBombCount:function(){var t=this;this.bombBox.forEach(function(e,o){if(0!==o){var i=t.bombCount[o];e.getChildByName("bottom_flex__item__content").getChildByName("bomb_count").getComponent(cc.Label).string="x "+i}})},gameOver:function(t){if("playing"!==this.gameStatus)return!1;this.gameStatus=t,this.board.getComponent("board").overHandler(),confirm("game over. you "+t+"! replay?")&&this.backToIntro()},onLoad:function(){this.bombActive=0,this.bombBox=[,this.bomb1,this.bomb2,this.bomb3],this.bombCount=[,28,1,1],this.gameStatus="playing",this.upgradeBombCount()},start:function(){var t=this;this.switchActive(null,1),this.board.getComponent("board").setGetActiveBombHandler(function(){return t.bombActive}),this.board.getComponent("board").setGameStatusHandler(this.gameOver.bind(this)),this.board.getComponent("board").setMinusBombCountHandler(this.minusBombCount.bind(this)),this.board.getComponent("board").startHandler()},backToIntro:function(){cc.director.loadScene("intro")}}),cc._RF.pop()},{}],intro:[function(t,e,o){"use strict";cc._RF.push(e,"561a64wySdGq64V0ju3ZvtG","intro"),cc.Class({extends:cc.Component,properties:{background:cc.Node},startGame:function(){cc.director.loadScene("game")},onLoad:function(){},start:function(){this.background.getComponent("background").setEnabled()},onDestroy:function(){}}),cc._RF.pop()},{}],meteor:[function(t,e,o){"use strict";cc._RF.push(e,"ab16126wxNNq6Dep10Xpyh+","meteor"),cc.Class({extends:cc.Component,getShipMeta:function(t,e){switch(t){case"A":return{w:100,h:100,minRow:0,minCol:0,maxRow:8,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1]]}};case"B":switch(e){case"U":case"D":return{w:150,h:100,minRow:0,minCol:0,maxRow:8,maxCol:7,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1],[t,e+2],[t+1,e+2]]}};case"L":case"R":return{w:100,h:150,minRow:0,minCol:0,maxRow:7,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t+2,e],[t,e+1],[t+1,e+1],[t+2,e+1]]}}}case"C":return{w:100,h:100,minRow:0,minCol:0,maxRow:8,maxCol:8,body:function(t,e){return[[t,e],[t+1,e],[t,e+1],[t+1,e+1]]}};case"D":case"E":return{w:50,h:50,minRow:0,minCol:0,maxRow:9,maxCol:9,body:function(t,e){return[[t,e]]}}}},getDirection:function(){return["U","D","L","R"][parseInt(4*Math.random())]},getLocation:function(){var t=this.getShipMeta(this.type,this.direction),e=t.minRow,o=t.minCol,i=t.maxRow,n=t.maxCol,r=t.body,s=parseInt(Math.random()*(i-e+1))+e,c=parseInt(Math.random()*(n-o+1))+o;this.origin={row:s,col:c},this.location=r(s,c)},setPosition:function(t,e){this.node.x=t,this.node.y=e},spawnMeteor:function(t){var e=this;this.type=t,this.direction=this.getDirection();var o=this.getShipMeta(this.type,this.direction),i=o.w,n=o.h;this.node.width=i,this.node.height=n,cc.loader.loadRes("images/Meteor_"+t+"/"+t+"_"+this.direction,cc.SpriteFrame,function(t,o){var i=e.node.getComponent(cc.Sprite);i.sizeMode=0,i.spriteFrame=o})},setShootDown:function(){this.isShootDown=!0,this.node.color=new cc.Color(255,0,0)},onLoad:function(){this.node.opacity=200,this.node.active=!1,this.isShootDown=!1},start:function(){}}),cc._RF.pop()},{}]},{},["background","board","game","intro","meteor"]);